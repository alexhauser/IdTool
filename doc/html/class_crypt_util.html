<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IdTool: CryptUtil Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IdTool_Icon_Small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IdTool
   &#160;<span id="projectnumber">0.4.2</span>
   </div>
   <div id="projectbrief">A tool for inspecting and manipulating SQRL identities.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="class_crypt_util-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CryptUtil Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A collection of static utility functions mostly dealing with SQRL-related cryptographic operations.  
 <a href="class_crypt_util.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a612c115123112345d6efb63c9cccf885"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a612c115123112345d6efb63c9cccf885">xorByteArrays</a> (QByteArray a, QByteArray b)</td></tr>
<tr class="separator:a612c115123112345d6efb63c9cccf885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42179651686b18b473260f909183e34a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a42179651686b18b473260f909183e34a">getRandomBytes</a> (QByteArray &amp;buffer)</td></tr>
<tr class="separator:a42179651686b18b473260f909183e34a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae53f902f4f425246ede45bda6770ab47"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#ae53f902f4f425246ede45bda6770ab47">getRandomByte</a> (unsigned char &amp;byte)</td></tr>
<tr class="separator:ae53f902f4f425246ede45bda6770ab47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a81cf4cb243ff5f417a2075b34a25f3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a0a81cf4cb243ff5f417a2075b34a25f3">enScryptIterations</a> (QByteArray &amp;result, QString password, QByteArray randomSalt, int logNFactor, int iterationCount, QProgressDialog *progressDialog=nullptr)</td></tr>
<tr class="separator:a0a81cf4cb243ff5f417a2075b34a25f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ca62f6f61938f49fc3aa50735a86517"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a3ca62f6f61938f49fc3aa50735a86517">enScryptTime</a> (QByteArray &amp;result, int &amp;iterationCount, QString password, QByteArray randomSalt, int logNFactor, int secondsToRun, QProgressDialog *progressDialog=nullptr)</td></tr>
<tr class="separator:a3ca62f6f61938f49fc3aa50735a86517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba18ca8d4fa784794d356bc3a9fc62c3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#aba18ca8d4fa784794d356bc3a9fc62c3">decryptBlock1</a> (QByteArray &amp;decryptedImk, QByteArray &amp;decryptedIlk, <a class="el" href="class_identity_block.html">IdentityBlock</a> *block, QByteArray key)</td></tr>
<tr class="separator:aba18ca8d4fa784794d356bc3a9fc62c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79783a142d8ed87a398e403f9f8d29af"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a79783a142d8ed87a398e403f9f8d29af">decryptBlock2</a> (QByteArray &amp;decryptedIuk, <a class="el" href="class_identity_block.html">IdentityBlock</a> *block, QString rescueCode, QProgressDialog *progressDialog=nullptr)</td></tr>
<tr class="separator:a79783a142d8ed87a398e403f9f8d29af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1ea9ea74742c6746fc31405c5b5f21"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a5e1ea9ea74742c6746fc31405c5b5f21">decryptBlock3</a> (QList&lt; QByteArray &gt; &amp;decryptedPreviousIuks, <a class="el" href="class_identity_block.html">IdentityBlock</a> *block, QByteArray imk)</td></tr>
<tr class="separator:a5e1ea9ea74742c6746fc31405c5b5f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8ab51874b2d29bcab242a622573a80e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#ac8ab51874b2d29bcab242a622573a80e">createSiteKeys</a> (QByteArray &amp;publicKey, QByteArray &amp;privateKey, QString domain, QString altId, QByteArray imk)</td></tr>
<tr class="separator:ac8ab51874b2d29bcab242a622573a80e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c56bb7a9a88df18fc5da9d2844265e0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a4c56bb7a9a88df18fc5da9d2844265e0">createKeyFromPassword</a> (QByteArray &amp;key, <a class="el" href="class_identity_block.html">IdentityBlock</a> &amp;block, QString password, QProgressDialog *progressDialog=nullptr)</td></tr>
<tr class="separator:a4c56bb7a9a88df18fc5da9d2844265e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a925177eb22eb84b24bf7bed54b7a713a"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a925177eb22eb84b24bf7bed54b7a713a">getHostLowercase</a> (QString url)</td></tr>
<tr class="separator:a925177eb22eb84b24bf7bed54b7a713a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3bdc6355d5cb915d1c40d98dee7e2bd"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#ac3bdc6355d5cb915d1c40d98dee7e2bd">makeHostLowercase</a> (QString url)</td></tr>
<tr class="memdesc:ac3bdc6355d5cb915d1c40d98dee7e2bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the host part of <em>url</em> to lowercase.  <a href="class_crypt_util.html#ac3bdc6355d5cb915d1c40d98dee7e2bd">More...</a><br /></td></tr>
<tr class="separator:ac3bdc6355d5cb915d1c40d98dee7e2bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1886e751bef3f8e105f32d02644bb815"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a1886e751bef3f8e105f32d02644bb815">createImkFromIuk</a> (QByteArray decryptedIuk)</td></tr>
<tr class="separator:a1886e751bef3f8e105f32d02644bb815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26663ba4efcf0dbbecfd9e7c248efbda"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a26663ba4efcf0dbbecfd9e7c248efbda">createIlkFromIuk</a> (QByteArray decryptedIuk)</td></tr>
<tr class="separator:a26663ba4efcf0dbbecfd9e7c248efbda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a395fffbca56d51eee1ac15eeef502138"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a395fffbca56d51eee1ac15eeef502138">createIndexedSecret</a> (QByteArray imk, QString domain, QString altId, QByteArray secretIndex)</td></tr>
<tr class="separator:a395fffbca56d51eee1ac15eeef502138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee8b42dca8f8032163fb7b840e50edc"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a9ee8b42dca8f8032163fb7b840e50edc">enHash</a> (QByteArray data)</td></tr>
<tr class="separator:a9ee8b42dca8f8032163fb7b840e50edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a3e00900c9c65036dd06b404743ebb5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_identity_block.html">IdentityBlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a9a3e00900c9c65036dd06b404743ebb5">createBlock1</a> (QByteArray iuk, QString password, QProgressDialog *progressDialog)</td></tr>
<tr class="separator:a9a3e00900c9c65036dd06b404743ebb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee20004a0442007d994df05444cbd48"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_identity_block.html">IdentityBlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a9ee20004a0442007d994df05444cbd48">createBlock2</a> (QByteArray iuk, QString rescueCode, QProgressDialog *progressDialog)</td></tr>
<tr class="separator:a9ee20004a0442007d994df05444cbd48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa331655590da573779467cc3c75921e6"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#aa331655590da573779467cc3c75921e6">updateBlock1WithPassword</a> (<a class="el" href="class_identity_block.html">IdentityBlock</a> *oldBlock, <a class="el" href="class_identity_block.html">IdentityBlock</a> *updatedBlock, QString password, QString newPassword, QProgressDialog *progressDialog)</td></tr>
<tr class="memdesc:aa331655590da573779467cc3c75921e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-encrypts and re-authenticates a type 1 block after a change to the plain-text settings or password.  <a href="class_crypt_util.html#aa331655590da573779467cc3c75921e6">More...</a><br /></td></tr>
<tr class="separator:aa331655590da573779467cc3c75921e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf7120a5249f804735016b42408314f2"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#acf7120a5249f804735016b42408314f2">updateBlock1</a> (<a class="el" href="class_identity_block.html">IdentityBlock</a> *block1, QByteArray unencryptedImk, QByteArray unencryptedIlk, QString newPassword, QProgressDialog *progressDialog)</td></tr>
<tr class="memdesc:acf7120a5249f804735016b42408314f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-encrypts and re-authenticates <em>block1</em> using the keys <em>unencryptedImk</em> and <em>unencryptedIlk</em> under <em>newPassword</em>.  <a href="class_crypt_util.html#acf7120a5249f804735016b42408314f2">More...</a><br /></td></tr>
<tr class="separator:acf7120a5249f804735016b42408314f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7375004821c0cfe8669512df63ccb0b5"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a7375004821c0cfe8669512df63ccb0b5">aesGcmEncrypt</a> (QByteArray message, QByteArray additionalData, QByteArray iv, QByteArray key)</td></tr>
<tr class="separator:a7375004821c0cfe8669512df63ccb0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77383d2f69f7b002c2afc8a107ee7e23"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a77383d2f69f7b002c2afc8a107ee7e23">createIuk</a> ()</td></tr>
<tr class="separator:a77383d2f69f7b002c2afc8a107ee7e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324cf1497a7099eab3654bf31ab6d082"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a324cf1497a7099eab3654bf31ab6d082">createNewRescueCode</a> ()</td></tr>
<tr class="separator:a324cf1497a7099eab3654bf31ab6d082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f02fc36cf9ac4a6e621a220767847ab"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a7f02fc36cf9ac4a6e621a220767847ab">formatRescueCode</a> (QString rescueCode)</td></tr>
<tr class="separator:a7f02fc36cf9ac4a6e621a220767847ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1095b65279f904c9097ddb7c2bd65c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a8f1095b65279f904c9097ddb7c2bd65c">createIdentity</a> (<a class="el" href="class_identity_model.html">IdentityModel</a> &amp;identity, QString &amp;rescueCode, QString password, QProgressDialog *progressDialog=nullptr)</td></tr>
<tr class="separator:a8f1095b65279f904c9097ddb7c2bd65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8807fe3a96255e07a211a6084c8a58de"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a8807fe3a96255e07a211a6084c8a58de">reverseByteArray</a> (QByteArray source)</td></tr>
<tr class="separator:a8807fe3a96255e07a211a6084c8a58de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e43ec029eb1a1efb70371f01250025"><td class="memItemLeft" align="right" valign="top">static BigUnsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a31e43ec029eb1a1efb70371f01250025">convertByteArrayToBigUnsigned</a> (QByteArray data)</td></tr>
<tr class="separator:a31e43ec029eb1a1efb70371f01250025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8609586b45d7144e13ff4feb4df45cce"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a8609586b45d7144e13ff4feb4df45cce">convertBigUnsignedToByteArray</a> (BigUnsigned bigNum)</td></tr>
<tr class="separator:a8609586b45d7144e13ff4feb4df45cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d62774ebb9f8233962acb4d4b95e27"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a30d62774ebb9f8233962acb4d4b95e27">base56EncodeIdentity</a> (QByteArray identityData)</td></tr>
<tr class="separator:a30d62774ebb9f8233962acb4d4b95e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7e6c5814464de4557ab4cb746b9c70"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a3e7e6c5814464de4557ab4cb746b9c70">createBase56CheckSumChar</a> (QByteArray dataBytes)</td></tr>
<tr class="separator:a3e7e6c5814464de4557ab4cb746b9c70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab43cb8d8cc98a7c712df3a410e01f285"><td class="memItemLeft" align="right" valign="top">static QByteArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#ab43cb8d8cc98a7c712df3a410e01f285">base56DecodeIdentity</a> (QString textualIdentity)</td></tr>
<tr class="separator:ab43cb8d8cc98a7c712df3a410e01f285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe67a0e659046fb7314a47c1710fa85f"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#afe67a0e659046fb7314a47c1710fa85f">formatTextualIdentity</a> (QString textualIdentity, bool escapeNewline=false)</td></tr>
<tr class="separator:afe67a0e659046fb7314a47c1710fa85f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3836398a3f0fcbb9b9018eabf538770c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a3836398a3f0fcbb9b9018eabf538770c">verifyTextualIdentity</a> (QString textualIdentity)</td></tr>
<tr class="separator:a3836398a3f0fcbb9b9018eabf538770c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435b7691c5d248ef6f1c7c12b821bd3c"><td class="memItemLeft" align="right" valign="top">static QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypt_util.html#a435b7691c5d248ef6f1c7c12b821bd3c">stripWhitespace</a> (QString source)</td></tr>
<tr class="separator:a435b7691c5d248ef6f1c7c12b821bd3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a3e4acec7fcd39d5e2da43c2453fed6dc"><td class="memItemLeft" align="right" valign="top"><a id="a3e4acec7fcd39d5e2da43c2453fed6dc"></a>
static const QByteArray&#160;</td><td class="memItemRight" valign="bottom"><b>BASE56_ALPHABET</b> = &quot;23456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz&quot;</td></tr>
<tr class="separator:a3e4acec7fcd39d5e2da43c2453fed6dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18f3473250abb77415a9ae1321856f8d"><td class="memItemLeft" align="right" valign="top"><a id="a18f3473250abb77415a9ae1321856f8d"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><b>BASE56_LINE_MAX_CHARS</b> = 19</td></tr>
<tr class="separator:a18f3473250abb77415a9ae1321856f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2935be2be247bfc9d7fc485364b1f86d"><td class="memItemLeft" align="right" valign="top"><a id="a2935be2be247bfc9d7fc485364b1f86d"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><b>BASE56_BASE_NUM</b> = 56</td></tr>
<tr class="separator:a2935be2be247bfc9d7fc485364b1f86d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A collection of static utility functions mostly dealing with SQRL-related cryptographic operations. </p>
<p><code><a class="el" href="class_crypt_util.html" title="A collection of static utility functions mostly dealing with SQRL-related cryptographic operations.">CryptUtil</a></code> implements most of the functionality described in <a href="https://www.grc.com/sqrl/SQRL_Cryptography.pdf">https://www.grc.com/sqrl/SQRL_Cryptography.pdf</a> </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7375004821c0cfe8669512df63ccb0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7375004821c0cfe8669512df63ccb0b5">&#9670;&nbsp;</a></span>aesGcmEncrypt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::aesGcmEncrypt </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>additionalData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Encrypts <em>message</em> under the secret key <em>key</em> and the initialization vector <em>iv</em>, adding in <em>additionalData</em> as additional data for the authenticated encryption.</p>
<p>The returned data contains the encrypted ciphertext as well as the generated authentication tag, which is being appended right after the ciphertext. </p>

</div>
</div>
<a id="ab43cb8d8cc98a7c712df3a410e01f285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab43cb8d8cc98a7c712df3a410e01f285">&#9670;&nbsp;</a></span>base56DecodeIdentity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::base56DecodeIdentity </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>textualIdentity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decodes the given base-56-encoded <em>textualIdentity</em> and if successful returns the decoded binary identity data. If the <em>textualIdentity</em> is invalid, an empty <code>QByteArray</code> will be returned.</p>
<dl class="section note"><dt>Note</dt><dd>See page 27 of <a href="https://www.grc.com/sqrl/SQRL_Cryptography.pdf">https://www.grc.com/sqrl/SQRL_Cryptography.pdf</a> for more information.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_crypt_util.html#a30d62774ebb9f8233962acb4d4b95e27">base56EncodeIdentity</a> </dd></dl>

</div>
</div>
<a id="a30d62774ebb9f8233962acb4d4b95e27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30d62774ebb9f8233962acb4d4b95e27">&#9670;&nbsp;</a></span>base56EncodeIdentity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::base56EncodeIdentity </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>identityData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a base-56-encoded textual representation of the provided binary <em>identityData</em>.</p>
<p>See page 27 of <a href="https://www.grc.com/sqrl/SQRL_Cryptography.pdf">https://www.grc.com/sqrl/SQRL_Cryptography.pdf</a> for more information.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_crypt_util.html#ab43cb8d8cc98a7c712df3a410e01f285">base56DecodeIdentity</a> </dd></dl>

</div>
</div>
<a id="a8609586b45d7144e13ff4feb4df45cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8609586b45d7144e13ff4feb4df45cce">&#9670;&nbsp;</a></span>convertBigUnsignedToByteArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::convertBigUnsignedToByteArray </td>
          <td>(</td>
          <td class="paramtype">BigUnsigned&#160;</td>
          <td class="paramname"><em>bigNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Converts a <code>BigUnsigned</code> unsigned integer into a raw byte array. </p>

</div>
</div>
<a id="a31e43ec029eb1a1efb70371f01250025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e43ec029eb1a1efb70371f01250025">&#9670;&nbsp;</a></span>convertByteArrayToBigUnsigned()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BigUnsigned CryptUtil::convertByteArrayToBigUnsigned </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Converts a raw byte array into a <code>BigUnsigned</code> unsigned integer representation using Matt McCutchen's C++ Big Integer Library at <a href="https://mattmccutchen.net/bigint/">https://mattmccutchen.net/bigint/</a> . </p>

</div>
</div>
<a id="a3e7e6c5814464de4557ab4cb746b9c70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e7e6c5814464de4557ab4cb746b9c70">&#9670;&nbsp;</a></span>createBase56CheckSumChar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char CryptUtil::createBase56CheckSumChar </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>dataBytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a checksum character from the given <em>dataBytes</em> according to the SQRL specification for creating/verifying the textual identity version. See "Textual Identity Format" in <a href="https://www.grc.com/sqrl/SQRL_Cryptography.pdf">https://www.grc.com/sqrl/SQRL_Cryptography.pdf</a> for more information. </p>

</div>
</div>
<a id="a9a3e00900c9c65036dd06b404743ebb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a3e00900c9c65036dd06b404743ebb5">&#9670;&nbsp;</a></span>createBlock1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_identity_block.html">IdentityBlock</a> CryptUtil::createBlock1 </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>iuk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates an <code><a class="el" href="class_identity_block.html" title="Represents a single identity block within the SQRL&#39;s S4 identity storage format.">IdentityBlock</a></code> of type 1, where the identity keys are being derived from <em>iuk</em> and encrypted under <em>password</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored. </p>

</div>
</div>
<a id="a9ee20004a0442007d994df05444cbd48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee20004a0442007d994df05444cbd48">&#9670;&nbsp;</a></span>createBlock2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_identity_block.html">IdentityBlock</a> CryptUtil::createBlock2 </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>iuk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>rescueCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates an <code><a class="el" href="class_identity_block.html" title="Represents a single identity block within the SQRL&#39;s S4 identity storage format.">IdentityBlock</a></code> of type 2 using <em>iuk</em> as the identity unlock key and encrypted under <em>rescueCode</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored. </p>

</div>
</div>
<a id="a8f1095b65279f904c9097ddb7c2bd65c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1095b65279f904c9097ddb7c2bd65c">&#9670;&nbsp;</a></span>createIdentity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::createIdentity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_identity_model.html">IdentityModel</a> &amp;&#160;</td>
          <td class="paramname"><em>identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString &amp;&#160;</td>
          <td class="paramname"><em>rescueCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a new SQRL identity, which is encrypted using <em>password</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<p>If successful, a valid <code><a class="el" href="class_identity_model.html" title="Represents a SQRL identity stored in the S4-format.">IdentityModel</a></code> is placed in <em>identity</em> and the rescue code is placed in <em>rescueCode</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if any of the crypotgraphic operations failed or the operation was cancelled by the user using the <code>QProgressDialog</code> 's "Cancel" button). </dd></dl>

</div>
</div>
<a id="a26663ba4efcf0dbbecfd9e7c248efbda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26663ba4efcf0dbbecfd9e7c248efbda">&#9670;&nbsp;</a></span>createIlkFromIuk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::createIlkFromIuk </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>decryptedIuk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Derives and returns an identity lock key (ILK) from the given identity unlock key <em>decryptedIuk</em> (IUK).</p>
<ul>
<li><dl class="section see"><dt>See also</dt><dd><a class="el" href="class_crypt_util.html#a1886e751bef3f8e105f32d02644bb815">createImkFromIuk</a> </dd></dl>
</li>
</ul>

</div>
</div>
<a id="a1886e751bef3f8e105f32d02644bb815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1886e751bef3f8e105f32d02644bb815">&#9670;&nbsp;</a></span>createImkFromIuk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::createImkFromIuk </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>decryptedIuk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Derives and returns an identity master key (IMK) from the given decrypted identity unlock key <em>decryptedIuk</em> (IUK).</p>
<p>This is a purpose-bound alias to the <code>enHash</code> function.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_crypt_util.html#a9ee8b42dca8f8032163fb7b840e50edc">enHash</a>, <a class="el" href="class_crypt_util.html#a26663ba4efcf0dbbecfd9e7c248efbda">createIlkFromIuk</a> </dd></dl>

</div>
</div>
<a id="a395fffbca56d51eee1ac15eeef502138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a395fffbca56d51eee1ac15eeef502138">&#9670;&nbsp;</a></span>createIndexedSecret()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::createIndexedSecret </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>imk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>altId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>secretIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates and returns the so called "indexed secret" (INS), given the identity's identity master key <em>imk</em>, the <em>domain</em> and the server-provided <em>secretIndex</em> (SIN).</p>
<p>In case of an error, an empty byte array is returned.</p>
<dl class="section note"><dt>Note</dt><dd>See <a href="https://www.grc.com/sqrl/SQRL_Cryptography.pdf">https://www.grc.com/sqrl/SQRL_Cryptography.pdf</a> on page 11 for more information. </dd></dl>

</div>
</div>
<a id="a77383d2f69f7b002c2afc8a107ee7e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77383d2f69f7b002c2afc8a107ee7e23">&#9670;&nbsp;</a></span>createIuk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::createIuk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates and returns a random 256 bit identity unlock key (IUK).</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>nullptr</code> if the operation fails. </dd></dl>

</div>
</div>
<a id="a4c56bb7a9a88df18fc5da9d2844265e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c56bb7a9a88df18fc5da9d2844265e0">&#9670;&nbsp;</a></span>createKeyFromPassword()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::createKeyFromPassword </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Derives a key from the given <em>password</em> using the scrypt parameters stored within <em>block</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<p>Upon success, the key is put into <em>key</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, and <code>false</code> otherwise. </dd></dl>

</div>
</div>
<a id="a324cf1497a7099eab3654bf31ab6d082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a324cf1497a7099eab3654bf31ab6d082">&#9670;&nbsp;</a></span>createNewRescueCode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::createNewRescueCode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates and returns a random, 24 digit rescue code string. </p><dl class="section return"><dt>Returns</dt><dd>Returns <code>nullptr</code> if the operation fails. </dd></dl>

</div>
</div>
<a id="ac8ab51874b2d29bcab242a622573a80e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8ab51874b2d29bcab242a622573a80e">&#9670;&nbsp;</a></span>createSiteKeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::createSiteKeys </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>publicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>privateKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>altId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>imk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a public- and private-key pair for <em>domain</em> and <em>altId</em> using the identity master key <em>imk</em>. Upon success, the public and private keys are stored within <em>publicKey</em> and <em>privateKey</em>.</p>
<p>If no alternate id is needed, an empty string shall be passed to <em>altId</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="aba18ca8d4fa784794d356bc3a9fc62c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba18ca8d4fa784794d356bc3a9fc62c3">&#9670;&nbsp;</a></span>decryptBlock1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::decryptBlock1 </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>decryptedImk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>decryptedIlk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypts the IMK and ILK contained within <em>block</em> using <em>key</em>, and upon success places them into <em>decryptedImk</em> and <em>decryptedIlk</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="a79783a142d8ed87a398e403f9f8d29af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79783a142d8ed87a398e403f9f8d29af">&#9670;&nbsp;</a></span>decryptBlock2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::decryptBlock2 </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>decryptedIuk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>rescueCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypts the IUK contained within <em>block</em> using <em>rescueCode</em>, and upon success places it into <em>decryptedIuk</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="a5e1ea9ea74742c6746fc31405c5b5f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1ea9ea74742c6746fc31405c5b5f21">&#9670;&nbsp;</a></span>decryptBlock3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::decryptBlock3 </td>
          <td>(</td>
          <td class="paramtype">QList&lt; QByteArray &gt; &amp;&#160;</td>
          <td class="paramname"><em>decryptedPreviousIuks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>imk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypts a list of previous IUKs contained within <em>block</em> using <em>imk</em> as the key, and upon success places them into <em>decryptedPreviousIuks</em> .</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="a9ee8b42dca8f8032163fb7b840e50edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee8b42dca8f8032163fb7b840e50edc">&#9670;&nbsp;</a></span>enHash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::enHash </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs 16 iterations of the SHA256 hash on <em>data</em>, with each successive output XORed to form a 1’s complement sum to produce the final result, which is then returned.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_crypt_util.html#a1886e751bef3f8e105f32d02644bb815">createImkFromIuk</a> </dd></dl>

</div>
</div>
<a id="a0a81cf4cb243ff5f417a2075b34a25f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a81cf4cb243ff5f417a2075b34a25f3">&#9670;&nbsp;</a></span>enScryptIterations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::enScryptIterations </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>randomSalt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>logNFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterationCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs <em>iterationCount</em> number of scrypt iterations on <em>password</em>, using the scrypt parameters <em>randomSalt</em> and <em>logNFactor</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<p>When successful, the result of the operation will be stored in <em>result</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="a3ca62f6f61938f49fc3aa50735a86517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ca62f6f61938f49fc3aa50735a86517">&#9670;&nbsp;</a></span>enScryptTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::enScryptTime </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>iterationCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>randomSalt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>logNFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>secondsToRun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs multiple scrypt iterations on <em>password</em> for a duration of <em>secondsToRun</em> seconds, using the the scrypt parameters <em>randomSalt</em> and <em>logNFactor</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<p>When successful, the result of the operation will be stored in <em>result</em> and the number of iterations that were run is placed in <em>iterationCount</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="a7f02fc36cf9ac4a6e621a220767847ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f02fc36cf9ac4a6e621a220767847ab">&#9670;&nbsp;</a></span>formatRescueCode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::formatRescueCode </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>rescueCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a formatted version of the given <em>rescueCode</em> string by inserting a dash after each 4th charcacter. If the given <em>rescueCode</em> does not have exactly 24 characters, it is being returned unaltered. Otherwise, the returned string will have the format ("1111-1111-1111-1111-1111-1111"). </p>

</div>
</div>
<a id="afe67a0e659046fb7314a47c1710fa85f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe67a0e659046fb7314a47c1710fa85f">&#9670;&nbsp;</a></span>formatTextualIdentity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::formatTextualIdentity </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>textualIdentity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>escapeNewline</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Formats the given <em>textualIdentity</em> string to groups of 5x4 characters per line, separated by a space.</p>
<p>If <em>escapeNewline</em> is <code>true</code>, newlines are escaped with "\n".</p>
<p>The output looks something like this:</p>
<p>jWJX JmD3 hUKQ qcRQ YRis <br  />
 Gnmx uQHs LaE5 vR2f V7At <br  />
 vW5g UQ5m B5kK gBjH 9uJr <br  />
 JQEF T7sm yYm7 USzH tmfu <br  />
 6ktj U86K Dqdz p8Gh TfZS <br  />
 UA8a G3F </p>

</div>
</div>
<a id="a925177eb22eb84b24bf7bed54b7a713a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a925177eb22eb84b24bf7bed54b7a713a">&#9670;&nbsp;</a></span>getHostLowercase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::getHostLowercase </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the host (domain) part of <em>url</em>, converted to lowercase. </p>

</div>
</div>
<a id="ae53f902f4f425246ede45bda6770ab47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae53f902f4f425246ede45bda6770ab47">&#9670;&nbsp;</a></span>getRandomByte()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::getRandomByte </td>
          <td>(</td>
          <td class="paramtype">unsigned char &amp;&#160;</td>
          <td class="paramname"><em>byte</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assigns a single random byte to <em>byte</em>.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed). </dd></dl>

</div>
</div>
<a id="a42179651686b18b473260f909183e34a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42179651686b18b473260f909183e34a">&#9670;&nbsp;</a></span>getRandomBytes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::getRandomBytes </td>
          <td>(</td>
          <td class="paramtype">QByteArray &amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Fills <em>buffer</em> with <code>buffer.length()</code> number of random bytes.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> on success, <code>false</code> otherwise (e.g. if initializing the crypto library failed) </dd></dl>

</div>
</div>
<a id="ac3bdc6355d5cb915d1c40d98dee7e2bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3bdc6355d5cb915d1c40d98dee7e2bd">&#9670;&nbsp;</a></span>makeHostLowercase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::makeHostLowercase </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Turns the host part of <em>url</em> to lowercase. </p>
<p>If no forward slash is found (no scheme or path present), the whole string <em>url</em> is turned into lowercase. </p>

</div>
</div>
<a id="a8807fe3a96255e07a211a6084c8a58de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8807fe3a96255e07a211a6084c8a58de">&#9670;&nbsp;</a></span>reverseByteArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::reverseByteArray </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reversers the given byte array and returns the result. e.g <code>"\0x00\0xFF"</code> becomes <code>"\0xFF\0x00"</code> </p>

</div>
</div>
<a id="a435b7691c5d248ef6f1c7c12b821bd3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a435b7691c5d248ef6f1c7c12b821bd3c">&#9670;&nbsp;</a></span>stripWhitespace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString CryptUtil::stripWhitespace </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Removes all occurrances of common "whitespace" characters from <em>source</em> and returns the result. </p>

</div>
</div>
<a id="acf7120a5249f804735016b42408314f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7120a5249f804735016b42408314f2">&#9670;&nbsp;</a></span>updateBlock1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::updateBlock1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> *&#160;</td>
          <td class="paramname"><em>block1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>unencryptedImk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>unencryptedIlk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>newPassword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Re-encrypts and re-authenticates <em>block1</em> using the keys <em>unencryptedImk</em> and <em>unencryptedIlk</em> under <em>newPassword</em>. </p>
<p><em>block1</em> shall already contain the required plain text changes, which are passed in as "additional data" to the AES GCM authenticated encryption. This function will create a new AES-GCM initialization vector as well as a new scrypt random salt and replace the existing values in <em>block1</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<p>If successful, <em>block1</em> will contain the re-encrypted and re-authenticated data.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> if the operation succeeds, <code>false</code> otherwise. </dd></dl>

</div>
</div>
<a id="aa331655590da573779467cc3c75921e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa331655590da573779467cc3c75921e6">&#9670;&nbsp;</a></span>updateBlock1WithPassword()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::updateBlock1WithPassword </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> *&#160;</td>
          <td class="paramname"><em>oldBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_identity_block.html">IdentityBlock</a> *&#160;</td>
          <td class="paramname"><em>updatedBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>oldPassword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>newPassword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QProgressDialog *&#160;</td>
          <td class="paramname"><em>progressDialog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Re-encrypts and re-authenticates a type 1 block after a change to the plain-text settings or password. </p>
<p>This function will decrypt the IMK and ILK of the (unmodified) <em>oldBlock</em> using <em>oldPassword</em> and subsequently re-encrypt and re-authenticate them within <em>updatedBlock</em> using <em>newPassword</em>.</p>
<p>If no password change is required, just pass in an identical password to <em>oldPassword</em> and <em>newPassword</em>.</p>
<p><em>updatedBlock</em> must be a copy of <em>oldBlock</em> but shall already contain the required plain text changes, which are passed in as "additional data" to the AES GCM authenticated encryption. This function will create a new AES-GCM initialization vector as well as a new scrypt random salt and replace the existing values in <em>updatedBlock</em>.</p>
<p>If a valid <em>progressDialog</em> pointer is given, the operation will use it to publish its progress. Otherwise, it will be ignored.</p>
<p>If successful, <em>updatedBlock</em> will contain the re-encrypted and re-authenticated data.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> if the operation succeeds, <code>false</code> otherwise. </dd></dl>

</div>
</div>
<a id="a3836398a3f0fcbb9b9018eabf538770c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3836398a3f0fcbb9b9018eabf538770c">&#9670;&nbsp;</a></span>verifyTextualIdentity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CryptUtil::verifyTextualIdentity </td>
          <td>(</td>
          <td class="paramtype">QString&#160;</td>
          <td class="paramname"><em>textualIdentity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Verifies if the given <em>textualIdentity</em> is a valid base56-encoded SQRL identity by checking the validity of the check characters.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>true</code> if the identity is valid and <code>false</code> otherwise. </dd></dl>

</div>
</div>
<a id="a612c115123112345d6efb63c9cccf885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a612c115123112345d6efb63c9cccf885">&#9670;&nbsp;</a></span>xorByteArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QByteArray CryptUtil::xorByteArrays </td>
          <td>(</td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QByteArray&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs a byte-by-byte XOR-operation on the given byte arrays <em>a</em> and <em>b</em> and returns the result. In order to maintain the cryptographic strengh of the XOR operation, both byte arrays must be of the same length (number of bytes) in order to avoid reuse of source material.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">A</td><td><code>std::runtime_error</code> is thrown if the byte arrays are not of equal size. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="cryptutil_8h_source.html">cryptutil.h</a></li>
<li>src/cryptutil.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
